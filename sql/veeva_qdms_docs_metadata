CREATE OR REPLACE TABLE  `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata (
  metadata_id BIGINT GENERATED BY DEFAULT AS IDENTITY,
  source_file_path string,
  rendition_type string,
  document_id bigint,
  document_name string,
  size bigint,
  status string,
  document_title string,
  document_type string,
  document_subtype string,
  doc_control_name string,
  doc_control_unit_id string,--doc_control_unit__c
  classification STRING,
  document_major_version bigint,
  document_minor_version bigint,
  lifecycle string,
  effective_date string,
  product string,
  product_name string, --product__v_name__v
  document_number string,
  owning_function_name string,
  owning_site_name string,
  is_latest_version boolean,
  file_modified_date string,
  version_modified_date string,
  pages bigint,
  dst_path string,
  batch_id bigint,
  document_s3_path string,
  extraction_status STRING,
  chunking_status STRING,
  embedding_status STRING,
  index_status STRING,
  download_status STRING,
  audit__created_date TIMESTAMP,
  audit__updated_date TIMESTAMP
) USING DELTA
LOCATION 's3://gilead-edp-pdm-dev-us-west-2-pdm-dl-quality-docs-genai/veeva_qdms_docs_metadata'
TBLPROPERTIES('delta.feature.allowColumnDefaults' = 'supported');

ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata
ALTER COLUMN extraction_status SET DEFAULT 'PENDING';

ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata
ALTER COLUMN chunking_status SET DEFAULT 'PENDING';

ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata
ALTER COLUMN embedding_status SET DEFAULT 'PENDING';

ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata
ALTER COLUMN index_status SET DEFAULT 'PENDING';

ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata
ALTER COLUMN audit__created_date SET DEFAULT current_timestamp();

ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata
ALTER COLUMN audit__updated_date SET DEFAULT current_timestamp();

ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata
ALTER COLUMN download_status SET DEFAULT 'PENDING';

ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata
ADD COLUMNS (is_latest_doc_in_dl BOOLEAN);

ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata
ALTER COLUMN is_latest_doc_in_dl SET DEFAULT True;
