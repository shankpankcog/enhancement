spark.sql(f"""CREATE OR REPLACE TABLE  `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test (
  metadata_id BIGINT GENERATED BY DEFAULT AS IDENTITY,
  source_file_path string,
  rendition_type string,
  document_id bigint,
  document_name string,
  size bigint,
  status string,
  document_title string,
  document_type string,
  document_subtype string,
  doc_control_name string,
  doc_control_unit_id string,
  classification STRING,
  document_major_version bigint,
  document_minor_version bigint,
  lifecycle string,
  effective_date string,
  product string,
  product_name string,
  document_number string,
  owning_function_name string,
  owning_site_name string,
  is_latest_version boolean,
  file_modified_date string,
  version_modified_date string,
  pages bigint,
  dst_path string,
  batch_id bigint,
  document_s3_path string,
  extraction_status STRING,
  chunking_status STRING,
  embedding_status STRING,
  index_status STRING,
  download_status STRING,
  audit__created_date TIMESTAMP,
  audit__updated_date TIMESTAMP
) USING DELTA
LOCATION 's3://gilead-edp-pdm-dev-us-west-2-pdm-gvault-platform/gvault/IT SOP/veeva_qdms_docs_metadata_sample_test'
TBLPROPERTIES('delta.feature.allowColumnDefaults' = 'supported');
""");


spark.sql(f"""ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test
ALTER COLUMN extraction_status SET DEFAULT 'PENDING';""");

spark.sql(f"""ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test
ALTER COLUMN chunking_status SET DEFAULT 'PENDING';""");

spark.sql(f"""ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test
ALTER COLUMN embedding_status SET DEFAULT 'PENDING';""");

spark.sql(f"""ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test
ALTER COLUMN index_status SET DEFAULT 'PENDING';""");

spark.sql(f"""ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test
ALTER COLUMN audit__created_date SET DEFAULT current_timestamp();""");

spark.sql(f"""ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test
ALTER COLUMN audit__updated_date SET DEFAULT current_timestamp();""");

spark.sql(f"""ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test
ALTER COLUMN download_status SET DEFAULT 'PENDING';""");

spark.sql(f"""ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test
ADD COLUMNS (is_latest_doc_in_dl BOOLEAN);""");

spark.sql(f"""ALTER TABLE `pdm-pdm-dl-quality-docs-genai-dev`.`gvault_test`.veeva_qdms_docs_metadata_sample_test
ALTER COLUMN is_latest_doc_in_dl SET DEFAULT True;""");
